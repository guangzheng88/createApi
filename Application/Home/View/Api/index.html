<!DOCTYPE html>
<html>
<head>
    <title>测试接口返回值</title>
    <script type="text/javascript" src="__PUBLIC__/home/js/jquery-1.7.2.js"></script>
</head>
<style type="text/css">
input{width: 400px;}
.remove,.addArrParam,.addArrParams,.addParam{margin-left:20px;font-size: 14px;color:white;border:1px solid #333;padding:0px 10px;background:#ff6633;}
a{text-decoration: none;cursor: pointer;}
.hideArr{display: none;}
.remove{background: #999;}
</style>
<body>
<if condition="!empty($_GET['apiDir'])">
    <p>
        单元测试文件生成成功，请将此内容粘贴至phpunit xml配置文件中<br>
        <textarea style="width: 800px;background:yellow;">
<file>../../../tests/controllers/{$Think.get.apiDir}/{$Think.get.apiName}/{$Think.get.apiName}{$Think.get.method}Test.php</file>
        </textarea>
    </p>
</if>
<h1 style="text-align: center;">测试接口返回值</h1>
<form action="__CONTROLLER__/submit" method="post" target="apiIframe" autocomplete="off">
    <table>
        <tr>
            <td>接口地址:</td>
            <td><input type="text"  name="bll_url" value="{$apiUrl}"></td>
        </tr>
        <tr>
            <td>请求方式</td>
            <td><input type="text" name="method" value="{$method}"></td>
        </tr>
        <tr>
            <td>参数名称</td>
            <td>参数值</td>
        </tr>
        <tr>
            <td><input type="text" name="key[]" style="width: 100px;" placeholder="参数名称"></td>
            <td><input type="text" name="value[]" placeholder="参数值"><a href="javascript:;" class="addParam">新增参数</a></td>
        </tr>
        <if condition="!empty($param)">
            <foreach name="param" item="val">
                <tr>
                    <td>
                        <input type="text" name="key[]" style="width: 100px;" value="{$val}">
                    </td>
                    <td>
                        <input type="text" name="value[]" value="{$key}">
                        <a href="javascript:;" class="remove">移除</a>
                    </td>
                </tr>
            </foreach>
        </if>
        <tr class="addAllParam">
            <td colspan="2"><a href="javascript:;" class="addArrParam" style="background:#ff0000;margin-left:0;">新增数组参数</a></td>
        </tr>
        <tr class="hideArr">
            <td>数组下标：</td>
            <td><input type="text" name="arrKey" placeholder="下标"></td>
        </tr>
        <tr class="hideArr">
            <td>
                <input type="text" name="arrParamKey[]" placeholder="参数名称" style="width: 100px;">
            </td>
            <td>
                <input type="text" name="arrParamValue[]" placeholder="参数值">
                <a href="javascript:;" class="addArrParams">+</a>
            </td>
        </tr>
        <tr class="addArrParams_befor">
            <td colspan="2"> <input type="submit" value="提交"></td>
        </tr>
    </table>
</form>
<hr>
<iframe src="__CONTROLLER__/submit" frameborder="0" width="100%" height="500" name="apiIframe"></iframe>
</body>
</html>
<script type="text/javascript">
    //新增参数
    $('.addParam').click(function(){
            var html = '<tr> <td><input type="text" name="key[]" style="width: 100px;" placeholder="参数名称"></td> <td><input type="text" name="value[]" placeholder="参数值"></td> </tr>';
            $('.addAllParam').before(html);
    });
    //新增数组参数
    $('.addArrParam').click(function(){
            $('.hideArr').show();
    });
    //新增数组参数的参数
    $('.addArrParams').click(function(){
        var html = '<tr> <td> <input type="text" name="arrParamKey[]" placeholder="参数名称" style="width: 100px;"></td> <td><input type="text" name="arrParamValue[]" placeholder="参数值"> </td> </tr>';
        $('.addArrParams_befor').before(html);
    });
    $('.remove').click(function(){
        $(this).parent().parent().remove();
    })
</script>